<div class="breadcrumb" style="margin-bottom: 10px !important;">
  <h1 class="pull-left">Resource Bookings Calendar</h1>
  <input type="text" placeholder="Search by client name, phone, email, Resource name,office" [formControl]="searchControl" class="form-control form-control-rounde pull-left w-40 ml-1" [(ngModel)]="search">
  <button class="btn btn-info btn-icon"><i class="i-Filter-2"></i></button>
  <div class="clear"></div>
</div>
<div class="card">
  <div class="">
    <div class="p-3 d-flex justify-content-between align-items-center calendar-title">
      <!-- Arrow navigations -->
      <div class="cal-top-col text-center">
        <button class="btn btn-rounded btn-icon btn-outline-primary m-1" mwlCalendarPreviousView [view]="view" [(viewDate)]="viewDate" (click)="loadEvents()">
          <i class="i-Arrow-Left"></i>
        </button>
        <button class="btn btn-rounded btn-icon btn-primary m-1" mwlCalendarToday [(viewDate)]="viewDate">
          <i class="i-Calendar-2"></i>
        </button>
        <button class="btn btn-rounded btn-icon btn-outline-primary m-1" mwlCalendarNextView [view]="view" [(viewDate)]="viewDate" (click)="loadEvents()">
          <i class="i-Arrow-Right"></i>
        </button>
      </div>
      <!-- Date title -->
      <div class=" text-center">
        <h5 class="m-0 text-muted f-b">{{ viewDate | calendarDate:(view + 'ViewTitle'):'en' }}</h5>
      </div>
      <!-- Month, day, week view toggle buttons -->
      <div class="d-flex justify-content-center">
        <button class="btn btn-rounded btn-icon btn-primary m-1" (click)="view = 'month'" [class.active]="view === 'month'" ngbTooltip="Month view" (click)="loadEvents()">
          <i class="i-Calendar"></i>
        </button>
        <button class="btn btn-rounded btn-icon btn-primary m-1" (click)="view = 'week'" [class.active]="view === 'week'" ngbTooltip="Week view" (click)="loadEvents()">
          <i class="i-Split-Vertical-2"></i>
        </button>
        <!--  <button class="btn btn-rounded btn-icon btn-primary m-1" (click)="view = 'day'" [class.active]="view === 'day'" ngbTooltip="Day view" (click)="loadEvents()">
          <i class="i-Align-Justify-All"></i>
        </button> -->
      </div>
    </div>
    <!-- <mat-divider></mat-divider> -->
  </div>
  <!-- Calendar -->
  <div class="p-0">
    <div [ngSwitch]="view">
      <mwl-calendar-month-view *ngSwitchCase="'month'" [viewDate]="viewDate" [events]="events" [refresh]="refresh" [activeDayIsOpen]="activeDayIsOpen" (dayClicked)="dayClicked($event.day)" (eventClicked)="handleEvent('edit', $event.event)" (eventTimesChanged)="eventTimesChanged($event)">
      </mwl-calendar-month-view>
      <mwl-calendar-week-view *ngSwitchCase="'week'" [viewDate]="viewDate" [events]="events" [refresh]="refresh" (eventClicked)="handleEvent('edit', $event.event)" (eventTimesChanged)="eventTimesChanged($event)">
      </mwl-calendar-week-view>
      <mwl-calendar-day-view *ngSwitchCase="'day'" [viewDate]="viewDate" [events]="events" [refresh]="refresh" (eventClicked)="handleEvent('edit', $event.event)" (eventTimesChanged)="eventTimesChanged($event)">
      </mwl-calendar-day-view>
    </div>
  </div>
</div>
<ng-template #onboardingModal let-modal>
  <loading [loading]="loading"></loading>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-title">ResurceBooking Schedule - {{schedule.refNo}}</h4>
    <span *ngIf="schedule.status=='Pending'" class="badge badge-info float-right">Pending</span>
    <span *ngIf="schedule.status=='Scheduled'" class="badge badge-primary float-right">Scheduled</span>
    <span *ngIf="schedule.status=='Cancelled'" class="badge badge-danger float-right">Cancelled</span>
    <span *ngIf="schedule.status=='Done'" class="badge badge-success float-right">Done</span>
    <button type="button" class="close" aria-label="Close button" aria-describedby="modal-title" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <ngb-accordion #acc="ngbAccordion" [activeIds]="['panel-0','panel-1','panel-2']">
      <ngb-panel id="panel-0">
        <ng-template ngbPanelTitle>
          <span class="pull-left d-ib f-b fs-14">Client Basic Data</span>
        </ng-template>
        <ng-template ngbPanelContent>
          <div class="row p-0">
            <div class="col-md-4 col-6 mb-2">
              <p class="text-muted mb-0">{{schedule.resource.type}}</p>
              <p class="f-b">{{schedule.resource.name}}</p>
            </div>
            <div class="col-md-6 col-6 mb-2">
              <p class="text-muted mb-0">Office & Location</p>
              <span class="f-b">{{schedule.resource?.office?.name}}, {{schedule.resource?.office?.building?.name}} {{schedule.resource?.office?.building?.address}}</span>
            </div>
            <div class="col-md-2 col-6 mb-2">
              <p class="text-muted mb-0">Booking Status </p>
              <span class="f-b">{{schedule.status}}</span>
            </div>
            <div class="col-md-4 col-6 mb-2">
              <p class="text-muted mb-0">Company </p>
              <span class="f-b">{{schedule.client?.company}}</span>
            </div>
            <div class="col-md-3 col-12 mb-2">
              <p class="text-muted mb-0">Contact Name</p>
              <span class="f-b">{{schedule.client?.name}}</span>
            </div>
            <div class="col-md-3 col-12 mb-2">
              <p class="text-muted mb-0">Email</p>
              <span class="f-b">{{schedule.client?.email}}</span>
            </div>
            <div class="col-md-2 col-12 mb-2">
              <p class="text-muted mb-0">Phone</p>
              <span class="f-b">{{schedule.client?.phone}}</span>
              <span class=""><button class="btn btn-outline-info btn-icon" ngbTooltip="Click to Call" (click)="callNow(schedule.client?.phone)"><i class="fa fa-phone"></i></button></span>
            </div>
          </div>
        </ng-template>
      </ngb-panel>
      <ngb-panel id="panel-1">
        <ng-template ngbPanelTitle>
          <span class="pull-left d-ib f-b fs-14">Schedule Time & Details</span>
        </ng-template>
        <ng-template ngbPanelContent>
          <div class="row p-0">
            <div class="col-md-4 col-12 mb-2">
              <p class="text-muted mb-0">Date & Time</p>
              <span class="fs-12 f-b">{{schedule.from | date : 'MMM dd, yyyy hh:mm a'}}</span>
            </div>
            <div class="col-md-4 col-12 mb-2">
              <p class="text-muted mb-0" *ngIf="schedule.status=='Pending'">Due Amount :</p>
              <p class="text-muted mb-0" *ngIf="schedule.status!='Pending'">Amount :</p>
              <span class="badge badge-success fs-12" *ngIf="schedule.status!='Pending'">{{schedule.amount | inr}}</span>
              <span class="badge badge-danger fs-12" *ngIf="schedule.status=='Pending'">{{schedule.amount | inr}}</span>
            </div>
          </div>
        </ng-template>
      </ngb-panel>
    </ngb-accordion>
  </div>
  <div class="modal-footer">
    <button class="btn btn-warning btn-ico" (click)="cancelBooking()" *ngIf="(schedule.status!='Done' && schedule.status!='Cancelled')"><i class="fa fa-times"></i> Cancel Booking</button>
    <button class="btn btn-info btn-ico" (click)="markAsDone()" ngbTooltip="Mark as Completed" *ngIf="(schedule.status!='Done' && schedule.status!='Cancelled')"><i class="fa fa-check"></i> Mark as Completed</button>
    <button type="button" class="btn btn-outline-light" (click)="modal.close('close click')">Close</button>
  </div>
</ng-template>
<div class="row">
  <div class=" col-4">
    <div class="breadcrumb">
      <h1 class="pull-left">Client Companies</h1>
    </div>
    <div class="clear"></div>
    <div class="separator-breadcrumb border-top mb-10 mt-10"></div>
    <div class="row">
      <div class="col-md-12">
        <div class="card  o-hidden">
          <table class="tableBodyScroll table table-striped table-hover table-sm">
            <thead>
              <tr>
                <th class="w-70 pl-2">Client Name</th>
                <th class="w-30 text-center">Action</th>
              </tr>
            </thead>
            <tbody class="tableBodyScroll" style="max-height: 325px;">
              <tr *ngFor="let client of companies;" [ngClass]="{'bg-primary text-white':client.id==selectedCompany.id}">
                <td class="w-70 pl-2">
                  <span>{{client.name}}</span>
                </td>
                <td class="w-30 text-center">
                  <button class="btn btn-icon btn-primary" ngbTooltip="View {{client.name}}" (click)="
                 selectCompany(client)"><i class="i-Blinklist"></i></button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  <div class="col-8">
    <div class="breadcrumb">
      <h1 class="pull-left">{{selectedCompany.name}}</h1>
      <button class="btn btn-outline-primar btn-sm btn-primary btn-rounde btn-ico pull-right" (click)="openCompanyModal()">
        <i class="fa fa-plus"></i> Company
      </button>
    </div>
    <div class="clear"></div>
    <div class="separator-breadcrumb border-top mb-10 mt-10"></div>
    <div class="card">
      <div class="card-body">
        <ngb-tabset class="nav-cente">
          <ngb-tab title="General Info">
            <ng-template ngbTabContent>
              <hr class="mt-0 mb-1" style="margin-top: -12px !important">
              <button class="btn btn-outline-primary btn-ico float-right" [disabled]="loading||companyForm.invalid" (click)="saveCompany()" style="margin-top: -40px !important"><i class="fa fa-check"></i> Update Company Details</button>
              <div class="d-ib float-right" style="margin-top: -40px !important;margin-right: 250px !important;">
                <label class="checkbox checkbox-success">
                  <input type="checkbox" [(ngModel)]="selectedCompany.active" (ngModelChange)="saveCompany()" [ngModelOptions]="{standalone: true}">
                  <span class="d-ib mt--10">Active </span>
                  <span class="checkmark"></span>
                </label>
              </div>
              <div class="clear"></div>
              <form [formGroup]="companyForm">
                <div class="row mt-1">
                  <div class="col-md-6 form-group mb-1">
                    <label>Name</label>
                    <input type="text" class="form-control" id="name" formControlName="name" placeholder="Enter Company Name" [(ngModel)]="selectedCompany.name">
                  </div>
                  <div class="col-md-6 form-group mb-1">
                    <label>Trade Name</label>
                    <input type="text" class="form-control" id="tradeName" formControlName="tradeName" placeholder="Enter Trade Name" [(ngModel)]="selectedCompany.tradeName">
                  </div>
                  <div class="col-md-4 form-group mb-1">
                    <label>ShortName</label>
                    <input type="text" class="form-control" id="shortName" formControlName="shortName" placeholder="Enter Short Name" [(ngModel)]="selectedCompany.shortName">
                  </div>
                  <div class="col-md-4 form-group mb-1">
                    <label>City</label>
                    <input type="text" class="form-control" id="city" formControlName="city" placeholder="Enter City" [(ngModel)]="selectedCompany.city">
                  </div>
                  <div class="col-md-4 form-group mb-1">
                    <label>State</label>
                    <input type="text" class="form-control" id="state" formControlName="state" placeholder="Enter State" [(ngModel)]="selectedCompany.state">
                  </div>
                  <div class="col-md-3 form-group mb-1">
                    <label>Phone</label>
                    <input type="text" class="form-control" id="phone" formControlName="phone" placeholder="Enter Phone" [(ngModel)]="selectedCompany.phone">
                  </div>
                  <div class="col-md-3 form-group mb-1">
                    <label>Email</label>
                    <input type="text" class="form-control" id="email" formControlName="email" placeholder="Enter Email" [(ngModel)]="selectedCompany.email">
                  </div>
                  <div class="col-md-3 form-group mb-1">
                    <label>Website</label>
                    <input type="text" class="form-control" id="website" formControlName="website" placeholder="Enter Website" [(ngModel)]="selectedCompany.website">
                  </div>
                  <div class="col-md-3 form-group mb-1">
                    <label>ERP Domain</label>
                    <input type="text" class="form-control" id="erpDomain" formControlName="erpDomain" placeholder="Enter ERP URL" [(ngModel)]="selectedCompany.erpDomain">
                  </div>
                  <div class="col-md-12 form-group mb-1">
                    <label>Address</label>
                    <textarea class="form-control" id="address" formControlName="address" placeholder="Enter Address" [(ngModel)]="selectedCompany.address"></textarea>
                  </div>
                </div>
              </form>
            </ng-template>
          </ngb-tab>
          <ngb-tab title="Contacts">
            <ng-template ngbTabContent>
              <hr class="mt-0 mb-1" style="margin-top: -12px !important">
              <button class="btn btn-outline-primary btn-ico float-right" (click)="openContactModal()" style="margin-top: -40px !important"><i class="fa fa-plus"></i> Contact</button>
              <div class="clear"></div>
              <table class="tableBodyScroll table table-striped table-hover table-sm">
                <thead>
                  <tr>
                    <th class="w-25">Name</th>
                    <th class="w-30">Email</th>
                    <th class="w-15">Phone</th>
                    <th class="w-25">Designation</th>
                    <th class="w-5"></th>
                  </tr>
                </thead>
                <tbody class="tableBodyScroll" style="max-height: 325px;">
                  <tr *ngFor="let contact of selectedCompany.contacts">
                    <td class="w-25">{{contact.name}}</td>
                    <td class="w-30">{{contact.email}}</td>
                    <td class="w-15">{{contact.phone}}</td>
                    <td class="w-25">
                      <div ngbTooltip="{{contact.contactPurposes}}">{{contact.designation}}</div>
                    </td>
                    <td class="w-5">
                      <button class="btn btn-sm btn-icon btn-outline-primary" ngbTooltip="Edit Contact" (click)="openContactModal(contact)"><i class="fa fa-pencil"></i></button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </ng-template>
          </ngb-tab>
          <ngb-tab title="Modules">
            <ng-template ngbTabContent>
              <hr class="mt-0 mb-1" style="margin-top: -12px !important">
              <div class="clear"></div>
              <div class="row">
                <div class="col-md-4 cursor" (click)="updateModule('bookings')">
                  <div class="card card-icon-bg card-icon-bg-primary o-hidden mb-4">
                    <div class="card-body text-center">
                      <i class="i-Library"></i>
                      <div class="content">
                        <p class="text-muted mt-2 mb-0">Bookings</p>
                        <div *ngIf="selectedCompany?.modules?.bookings" class="text-success text-center w-100 mb-2 f-b"><i style="font-size:24px !important;" class="fa fa-check"></i></div>
                        <div *ngIf="!selectedCompany?.modules?.bookings" class="text-light text-center w-100 mb-2 f-b"><i style="font-size:24px !important;" class="fa fa-times"></i></div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-4 cursor" (click)="updateModule('accounts')">
                  <div class="card card-icon-bg card-icon-bg-primary o-hidden mb-4">
                    <div class="card-body text-center">
                      <i class="i-Money-2"></i>
                      <div class="content">
                        <p class="text-muted mt-2 mb-0">Accounts</p>
                        <div *ngIf="selectedCompany?.modules?.accounts" class="text-success text-center w-100 mb-2 f-b"><i style="font-size:24px !important;" class="fa fa-check"></i></div>
                        <div *ngIf="!selectedCompany?.modules?.accounts" class="text-light text-center w-100 mb-2 f-b"><i style="font-size:24px !important;" class="fa fa-times"></i></div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-4 cursor" (click)="updateModule('purchases')">
                  <div class="card card-icon-bg card-icon-bg-primary o-hidden mb-4">
                    <div class="card-body text-center">
                      <i class="i-Cash-register-2"></i>
                      <div class="content">
                        <p class="text-muted mt-2 mb-0">Purchases</p>
                        <div *ngIf="selectedCompany?.modules?.purchases" class="text-success text-center w-100 mb-2 f-b"><i style="font-size:24px !important;" class="fa fa-check"></i></div>
                        <div *ngIf="!selectedCompany?.modules?.purchases" class="text-light text-center w-100 mb-2 f-b"><i style="font-size:24px !important;" class="fa fa-times"></i></div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-4 cursor" (click)="updateModule('support')">
                  <div class="card card-icon-bg card-icon-bg-primary o-hidden mb-4">
                    <div class="card-body text-center">
                      <i class="i-Support"></i>
                      <div class="content">
                        <p class="text-muted mt-2 mb-0">Support</p>
                        <div *ngIf="selectedCompany?.modules?.support" class="text-success text-center w-100 mb-2 f-b"><i style="font-size:24px !important;" class="fa fa-check"></i></div>
                        <div *ngIf="!selectedCompany?.modules?.support" class="text-light text-center w-100 mb-2 f-b"><i style="font-size:24px !important;" class="fa fa-times"></i></div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-4 cursor" (click)="updateModule('assets')">
                  <div class="card card-icon-bg card-icon-bg-primary o-hidden mb-4">
                    <div class="card-body text-center">
                      <i class="i-Jeep-2"></i>
                      <div class="content">
                        <p class="text-muted mt-2 mb-0">Assets</p>
                        <div *ngIf="selectedCompany?.modules?.assets" class="text-success text-center w-100 mb-2 f-b"><i style="font-size:24px !important;" class="fa fa-check"></i></div>
                        <div *ngIf="!selectedCompany?.modules?.assets" class="text-light text-center w-100 mb-2 f-b"><i style="font-size:24px !important;" class="fa fa-times"></i></div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="col-md-4 cursor" (click)="updateModule('leads')">
                  <div class="card card-icon-bg card-icon-bg-primary o-hidden mb-4">
                    <div class="card-body text-center">
                      <i class="i-MaleFemale"></i>
                      <div class="content">
                        <p class="text-muted mt-2 mb-0">Leads</p>
                        <div *ngIf="selectedCompany?.modules?.leads" class="text-success text-center w-100 mb-2 f-b"><i style="font-size:24px !important;" class="fa fa-check"></i></div>
                        <div *ngIf="!selectedCompany?.modules?.leads" class="text-light text-center w-100 mb-2 f-b"><i style="font-size:24px !important;" class="fa fa-times"></i></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </ng-template>
          </ngb-tab>
          <ngb-tab title="Admin Users">
            <ng-template ngbTabContent>
              <hr class="mt-0 mb-1" style="margin-top: -12px !important">
              <button class="btn btn-outline-primary btn-ico float-right" (click)="openUserModal()" style="margin-top: -40px !important"><i class="fa fa-plus"></i> Admin</button>
              <div class="clear"></div>
              <table class="tableBodyScroll table table-striped table-hover table-sm">
                <thead>
                  <tr>
                    <th class="w-35">Name</th>
                    <th class="w-40">Email</th>
                    <th class="w-15">Phone</th>
                    <th class="w-5"></th>
                  </tr>
                </thead>
                <tbody class="tableBodyScroll" style="max-height: 325px;">
                  <tr *ngFor="let user of selectedCompany.users">
                    <td class="w-35">{{user.name}}</td>
                    <td class="w-40">{{user.email}}</td>
                    <td class="w-15">{{user.phone}}</td>
                    <td class="w-5">
                      <button class="btn btn-sm btn-icon btn-outline-primary" ngbTooltip="Edit Contact" (click)="openUserModal(user)"><i class="fa fa-pencil"></i></button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </ng-template>
          </ngb-tab>
        </ngb-tabset>
      </div>
    </div>
  </div>
</div>
<ng-template #contactModal let-modal>
  <loading [loading]="loading" [type]="'loader-bubble'"></loading>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">{{contact.id ? 'Edit Contact' : 'New Contact'}}</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <form [formGroup]="contactForm">
      <div class="row">
        <div class="col-md-6 form-group mb-1">
          <label for="firstName">Name</label>
          <input type="text" class="form-control" id="name" formControlName="name" placeholder="Contact Name" [(ngModel)]="contact.name">
        </div>
        <div class="col-md-6 form-group mb-1">
          <label for="firstName">Designation</label>
          <input type="text" class="form-control" id="designation" formControlName="designation" placeholder="Enter Designation" [(ngModel)]="contact.designation">
        </div>
        <div class="col-md-6 form-group mb-1">
          <label for="roles">Phone</label>
          <input type="number" placeholder="Enter Phone number" class="form-control" name="phone" [(ngModel)]="contact.phone" formControlName="phone" />
        </div>
        <div class="col-md-6 form-group mb-1">
          <label for="firstName">Email</label>
          <input type="text" class="form-control" id="email" formControlName="email" placeholder="Enter Email" [(ngModel)]="contact.email">
        </div>
        <div class="col-md-12 form-group mb-1">
          <label for="firstName">Contact Purposes</label>
          <ng-select [items]="contactPurposes" [multiple]="true" [closeOnSelect]="false" [hideSelected]="true" [bindLabel]="'name'" placeholder="Select Contact Puposes" [(ngModel)]="contact.contactPurposes" formControlName="contactPurposes" name="contactPurposes"> </ng-select>
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-light" (click)="modal.close('close click')">Close</button>
    <button class="btn btn-info btn-sm ladda-button btn-ico" [ladda]="loading" [disabled]="loading||contactForm.invalid" (click)="saveContact()"><i class="fa fa-check" *ngIf="!loading"></i> Save</button>
  </div>
</ng-template>
<ng-template #userModal let-modal>
  <loading [loading]="loading" [type]="'loader-bubble'"></loading>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">{{user.id ? 'Edit User' : 'New User'}}</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <form [formGroup]="userForm">
      <div class="row">
        <div class="col-md-6 form-group mb-1">
          <label for="firstName">Name</label>
          <input type="text" class="form-control" id="name" formControlName="name" placeholder="User Name" [(ngModel)]="user.name">
        </div>
        <div class="col-md-6 form-group mb-1">
          <label for="roles">Phone</label>
          <input type="number" placeholder="Enter Phone number" class="form-control" name="phone" [(ngModel)]="user.phone" formControlName="phone" />
        </div>
        <div class="col-md-6 form-group mb-1">
          <label for="firstName">Email</label>
          <input type="text" class="form-control" id="email" formControlName="email" placeholder="Enter Email" [(ngModel)]="user.email">
        </div>
        <div class="col-md-6 form-group mb-1">
          <label for="firstName">Password</label>
          <input type="password" class="form-control" id="password" formControlName="password" placeholder="Enter Email" [(ngModel)]="user.password">
        </div>
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-light" (click)="modal.close('close click')">Close</button>
    <button class="btn btn-info btn-sm ladda-button btn-ico" [ladda]="loading" [disabled]="loading||userForm.invalid" (click)="saveUser()"><i class="fa fa-check" *ngIf="!loading"></i> Save</button>
  </div>
</ng-template>
<ng-template #companyModal let-modal>
  <loading [loading]="loading" [type]="'loader-bubble'"></loading>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">New Company</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="row">
      <div class="col-md-12 form-group mb-1">
        <label for="firstName">Name</label>
        <input type="text" class="form-control" id="name" placeholder="Company Name" [(ngModel)]="selectedCompany.name">
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-light" (click)="modal.close('close click')">Close</button>
    <button class="btn btn-info btn-sm ladda-button btn-ico" [ladda]="loading" [disabled]="loading||!selectedCompany.name" (click)="saveCompany()"><i class="fa fa-check" *ngIf="!loading"></i> Save</button>
  </div>
</ng-template>